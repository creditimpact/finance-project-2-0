# תהליך Tri-Merge

מסמך זה מתאר את נרמול הדוחות, התאמת המשפחות, זיהוי חוסר התאמה והעברת אותות במורד הפייפליין.

## נרמול
פלט הקורא לקובץ ה-PDF עובר נרמול כדי לאחד שמות שדות, פורמטים של תאריכים ומזהי חשבון. צעד זה מאפשר להשוות בין נתונים ממקורות שונים.

## התאמת משפחות
לאחר הנרמול מקבצים חשבונות השייכים לאותו לקוח למשפחות ומבצעים התאמה בין לשכות האשראי השונות. התאמה זו מסמנת אילו רשומות מייצגות את אותו החשבון.

## זיהוי חוסר התאמה
בין הרשומות המתאימות משווים מאפיינים מרכזיים ומזהים פערים. הפלט כולל רשימת חוסר התאמות אשר מועברת לשלב הבא.

## העברת אותות במורד הפייפליין
האינדיקציות שנמצאו בשלב הזיהוי נשלחות לשלב [Stage 2.5](../STAGE_2_5.md), שם הן משמשות לבניית בסיס אסטרטגי להמשך.

## רישום לוגים
כדי למנוע נפח לוגים גבוה, אירועי משפחה נרשמים רק ב־10% מהמקרים (`if random() < 0.1`).

## תרשים זרימה
התרשים הבא מציג את הרצף הכולל של השלבים:

![תרשים הזרימה](flow.mmd)
